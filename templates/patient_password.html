<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Registration | Set Password</title>
    <link rel="stylesheet" href="../static/patient_password.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <form class="form-card" id="passwordForm" method="POST" action="{{ url_for('routes.patient_password') }}" >
        <h2>Secure Your Account</h2>
        <p class="subtitle">Please create a strong password to protect your professional account.</p>

        <div class="section">
            <h3>Security Credentials</h3>

            <div class="form-group">
                <input type="password" name="password" id="password" required>
                <label for="password">Set Password*</label>
                <i class="fas fa-eye toggle-password" onclick="toggleVisibility('password', this)"></i>
                <small class="error">Password is required</small>
            </div>

            <div class="form-group">
                <input type="password" name="confirm_password" id="confirm_password" required>
                <label for="confirm_password">Confirm Password*</label>
                <i class="fas fa-eye toggle-password" onclick="toggleVisibility('confirm_password', this)"></i>
                <small class="error" id="match-error">Passwords do not match</small>
            </div>
        </div>

       <button type="submit" style="text-decoration: none;color: white;">Submit Personal Details> </button>
        <div class="subtitle" style="margin-top: 20px;">
        <span style="color:grey">Already have an account? </span><a href="/patientlogin" style="color: #3182ce; text-decoration: none; font-weight: bold;">Login here</a>
    </div>
        
    </form>
    
    <script>
    const form = document.getElementById('passwordForm');
    const passInput = document.getElementById('password');
    const confirmInput = document.getElementById('confirm_password');
    const inputs = document.querySelectorAll('input');

    function toggleVisibility(id, icon) {
        const field = document.getElementById(id);
        if (field.type === "password") {
            field.type = "text";
            icon.classList.replace("fa-eye", "fa-eye-slash");
        } else {
            field.type = "password";
            icon.classList.replace("fa-eye-slash", "fa-eye");
        }
    }

    inputs.forEach(input => {
        input.addEventListener('input', () => {
            input.value !== ''
                ? input.classList.add('not-empty')
                : input.classList.remove('not-empty');
        });
    });

    form.addEventListener('submit', (e) => {
        let isValid = true;

        inputs.forEach(input => {
            const errorMsg = input.parentElement.querySelector('.error');
            if (!input.value.trim()) {
                isValid = false;
                input.classList.add('invalid');
                errorMsg.style.display = 'block';
            } else {
                input.classList.remove('invalid');
                errorMsg.style.display = 'none';
            }
        });

        if (passInput.value !== confirmInput.value) {
            isValid = false;
            confirmInput.classList.add('invalid');
            document.getElementById('match-error').style.display = 'block';
        }

        
        if (!isValid) {
            e.preventDefault();
        }
    });
</script>
</body>
</html>